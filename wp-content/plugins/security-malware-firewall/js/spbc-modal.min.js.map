{"version":3,"file":"spbc-modal.min.js","sources":["spbc-modal.js"],"sourcesContent":["/* Cleantalk Modal object */\nspbcModal = {\n\n    // Flags\n    loaded: false,\n    loading: false,\n    opened: false,\n    opening: false,\n\n    // Methods\n    load: function( action, dataToSend = {} ) {\n        if ( ! this.loaded ) {\n            this.loading = true;\n            callback = function( result, data, params, obj ) {\n                spbcModal.loading = false;\n                spbcModal.loaded = result;\n                document.dispatchEvent(\n                    new CustomEvent( 'spbcModalContentLoaded', {\n                        bubbles: true,\n                    } ),\n                );\n            };\n            if ( typeof spbcSendAJAXRequest === 'function' ) {\n                if ( dataToSend ) {\n                    spbcSendAJAXRequest(\n                        {'action': action, 'data': dataToSend},\n                        {'callback': callback, 'notJson': true},\n                    );\n                } else {\n                    spbcSendAJAXRequest( {'action': action}, {'callback': callback, 'notJson': true} );\n                }\n            }\n        }\n    },\n\n    putError: function( errorText, hideSupportLink = false) {\n        let html = '<h2>An error</h2>' +\n            '<p>' + errorText + '</p>';\n        let supportUrl = spbcSettings['default_wl_support_url'];\n        if (spbcSettings['wl_mode_enabled']) {\n            supportUrl = spbcSettings['wl_support_url'];\n        }\n        if (!hideSupportLink) {\n            html += '<a style=\"text-align: left;' +\n                    'margin-top: 40px;\" target=\"_blank\" ' +\n                    'href='+ supportUrl + '>Contact tech support</a>';\n        }\n        this.put(html);\n    },\n\n    put: function( html ) {\n        spbcModal.loading = false;\n        spbcModal.loaded = html;\n        document.dispatchEvent(\n            new CustomEvent( 'spbcModalContentLoaded', {\n                bubbles: true,\n            } ),\n        );\n    },\n\n    confirm: function(header, text = '', filePath = '', callback, yesButtonText = 'Yes', noButtonText = 'No') {\n        spbcModal.loading = false;\n        let contentBlock = document.getElementById('spbc-modal-content');\n        if (contentBlock) {\n            contentBlock.innerHTML = '';\n\n            const headerBlock = document.createElement('div');\n            headerBlock.className = 'spbc-modal-header';\n            headerBlock.textContent = header;\n            contentBlock.append(headerBlock);\n\n            // Create text block\n            const textBlock = document.createElement('div');\n            textBlock.className = 'spbc-modal-text-block';\n            contentBlock.append(textBlock);\n\n            const fullLinkPath = filePath;\n\n            if (filePath && filePath.length > 60) {\n                filePath = '...' + filePath.slice(filePath.length - 60);\n            }\n\n            const textElem = document.createElement('div');\n            textElem.className = 'spbc-modal-text';\n            textElem.textContent = text;\n            textBlock.append(textElem);\n\n            const pathElemWrapper = document.createElement('div');\n            pathElemWrapper.className = 'spbc-modal-file_path_wrapper';\n            textBlock.append(pathElemWrapper);\n            const pathElem = document.createElement('span');\n            pathElem.className = 'spbc-modal-file_path';\n            pathElem.textContent = filePath ? filePath : '';\n            pathElem.title = fullLinkPath;\n            pathElemWrapper.append(pathElem);\n\n            // Create buttons block\n            const buttonsBlock = document.createElement('div');\n            buttonsBlock.className = 'spbc-modal-buttons-block';\n            contentBlock.append(buttonsBlock);\n\n            const yesButton = document.createElement('button');\n            yesButton.className = 'spbc-modal-button spbc_manual_link';\n            yesButton.textContent = yesButtonText;\n            yesButton.onclick = function() {\n                callback(true);\n                spbcModal.close();\n            };\n            buttonsBlock.append(yesButton);\n\n            const noButton = document.createElement('button');\n            noButton.className = 'spbc-modal-button spbc_manual_link';\n            noButton.textContent = noButtonText;\n            noButton.onclick = function() {\n                spbcModal.close();\n            };\n            buttonsBlock.append(noButton);\n        }\n        document.dispatchEvent(\n            new CustomEvent( 'spbcModalContentLoaded', {\n                bubbles: true,\n            } ),\n        );\n    },\n\n    open: function() {\n        /* Cleantalk Modal CSS start */\n        let renderCss = function() {\n            let cssStr = '';\n            for ( key in this.styles ) {\n                if (key) {\n                    cssStr += key + ':' + this.styles[key] + ';';\n                }\n            }\n            return cssStr;\n        };\n        let overlayCss = {\n            styles: {\n                'z-index': '9999',\n                'position': 'fixed',\n                'top': '0',\n                'left': '0',\n                'width': '100%',\n                'height': '100%',\n                'background': 'rgba(0,0,0,0.5)',\n                'display': 'flex',\n                'justify-content': 'center',\n                'align-items': 'center',\n            },\n            toString: renderCss,\n        };\n        let innerCss = {\n            styles: {\n                'position': 'relative',\n                'padding': '20px',\n                'margin': '10px',\n                'max-width': '550px',\n                'background': '#FFF',\n                'border': '1px solid rgba(0,0,0,0.75)',\n                'border-radius': '4px',\n                'box-shadow': '7px 7px 5px 0px rgba(50,50,50,0.75)',\n            },\n            toString: renderCss,\n        };\n        let closeCss = {\n            styles: {\n                'position': 'absolute',\n                'background': '#FFF',\n                'width': '20px',\n                'height': '20px',\n                'border': '2px solid rgba(0,0,0,0.75)',\n                'border-radius': '15px',\n                'cursor': 'pointer',\n                'top': '-8px',\n                'right': '-8px',\n            },\n            toString: renderCss,\n        };\n        let closeCssBefore = {\n            styles: {\n                'content': '\"\"',\n                'display': 'block',\n                'position': 'absolute',\n                'background': '#000',\n                'border-radius': '1px',\n                'width': '2px',\n                'height': '16px',\n                'top': '2px',\n                'left': '9px',\n                'transform': 'rotate(45deg)',\n            },\n            toString: renderCss,\n        };\n        let closeCssAfter = {\n            styles: {\n                'content': '\"\"',\n                'display': 'block',\n                'position': 'absolute',\n                'background': '#000',\n                'border-radius': '1px',\n                'width': '2px',\n                'height': '16px',\n                'top': '2px',\n                'left': '9px',\n                'transform': 'rotate(-45deg)',\n            },\n            toString: renderCss,\n        };\n        let contentCss = {\n            styles: {\n                'display': 'grid',\n                'gap': '20px',\n                'overflow-y': 'auto',\n                'overflow-x': 'hidden',\n            },\n            toString: renderCss,\n        };\n        let bodyCss = {\n            styles: {\n                'overflow': 'hidden',\n            },\n            toString: renderCss,\n        };\n        let spbcModalStyle = document.createElement( 'style' );\n        spbcModalStyle.setAttribute( 'id', 'spbc-modal-styles' );\n        spbcModalStyle.innerHTML = 'body.spbc-modal-opened{' + bodyCss + '}';\n        spbcModalStyle.innerHTML += '#spbc-modal-overlay{' + overlayCss + '}';\n        spbcModalStyle.innerHTML += '#spbc-modal-close{' + closeCss + '}';\n        spbcModalStyle.innerHTML += '#spbc-modal-close:before{' + closeCssBefore + '}';\n        spbcModalStyle.innerHTML += '#spbc-modal-close:after{' + closeCssAfter + '}';\n        spbcModalStyle.innerHTML += '#spbc-modal-content{' + contentCss + '}';\n        document.body.append( spbcModalStyle );\n        /* Cleantalk Modal CSS end */\n\n        let overlay = document.createElement( 'div' );\n        overlay.setAttribute( 'id', 'spbc-modal-overlay' );\n        document.body.append( overlay );\n\n        document.body.classList.add( 'spbc-modal-opened' );\n\n        let inner = document.createElement( 'div' );\n        inner.setAttribute( 'id', 'spbc-modal-inner' );\n        inner.setAttribute( 'style', innerCss );\n        overlay.append( inner );\n\n        let close = document.createElement( 'div' );\n        close.setAttribute( 'id', 'spbc-modal-close' );\n        inner.append( close );\n\n        let content = document.createElement( 'div' );\n        if ( this.loaded ) {\n            content.innerHTML = this.loaded;\n        } else {\n            content.innerHTML = 'Loading...';\n        }\n        content.setAttribute( 'id', 'spbc-modal-content' );\n        inner.append( content );\n\n        this.opened = true;\n\n        return this;\n    },\n\n    close: function() {\n        spbcModal.loaded = '';\n        spbcModal.loading = false;\n        document.body.classList.remove( 'spbc-modal-opened' );\n        document.getElementById( 'spbc-modal-overlay' ).remove();\n        document.getElementById( 'spbc-modal-styles' ).remove();\n        document.dispatchEvent(\n            new CustomEvent( 'spbcModalClosed', {\n                bubbles: true,\n            } ),\n        );\n    },\n\n};\n\n/* Cleantalk Modal helpers */\ndocument.addEventListener('click', function( e ) {\n    if ( e.target && e.target.id === 'spbc-modal-overlay' || e.target.id === 'spbc-modal-close' ) {\n        spbcModal.close();\n    }\n});\ndocument.addEventListener('spbcModalContentLoaded', function( e ) {\n    if ( spbcModal.opened && spbcModal.loaded ) {\n        document.getElementById( 'spbc-modal-content' ).innerHTML = spbcModal.loaded;\n    }\n});\n"],"names":["spbcModal","loaded","loading","opened","opening","load","action","dataToSend","this","callback","result","data","params","obj","document","dispatchEvent","CustomEvent","bubbles","spbcSendAJAXRequest","notJson","putError","errorText","hideSupportLink","let","html","supportUrl","spbcSettings","put","confirm","header","text","filePath","yesButtonText","noButtonText","pathElem","noButton","contentBlock","getElementById","innerHTML","headerBlock","createElement","className","textContent","append","textBlock","fullLinkPath","length","slice","textElem","pathElemWrapper","title","buttonsBlock","yesButton","onclick","close","open","renderCss","cssStr","key","styles","overlayCss","z-index","position","top","left","width","height","background","display","justify-content","align-items","toString","innerCss","padding","margin","max-width","border","border-radius","box-shadow","closeCss","cursor","right","closeCssBefore","content","transform","closeCssAfter","contentCss","gap","overflow-y","overflow-x","bodyCss","overflow","spbcModalStyle","overlay","setAttribute","body","inner","classList","add","remove","addEventListener","e","target","id"],"mappings":"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"}